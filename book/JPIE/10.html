<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>10강 | 끄적끄적 블로그</title>
    <meta name="description" content="개발 관련 블로그">
    <link rel="icon" href="/study-collection/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons">
    
    <link rel="preload" href="/study-collection/assets/css/0.styles.d9b30d9c.css" as="style"><link rel="preload" href="/study-collection/assets/js/app.9903441f.js" as="script"><link rel="preload" href="/study-collection/assets/js/2.aa424286.js" as="script"><link rel="preload" href="/study-collection/assets/js/90.82984209.js" as="script"><link rel="prefetch" href="/study-collection/assets/js/10.01e355bd.js"><link rel="prefetch" href="/study-collection/assets/js/100.50a285de.js"><link rel="prefetch" href="/study-collection/assets/js/101.5abb9bb7.js"><link rel="prefetch" href="/study-collection/assets/js/102.7056d3fc.js"><link rel="prefetch" href="/study-collection/assets/js/103.22f37fac.js"><link rel="prefetch" href="/study-collection/assets/js/104.64e1830d.js"><link rel="prefetch" href="/study-collection/assets/js/105.fff365d8.js"><link rel="prefetch" href="/study-collection/assets/js/106.9413b576.js"><link rel="prefetch" href="/study-collection/assets/js/107.9764414f.js"><link rel="prefetch" href="/study-collection/assets/js/108.581f137f.js"><link rel="prefetch" href="/study-collection/assets/js/109.5a24db7f.js"><link rel="prefetch" href="/study-collection/assets/js/11.ba7d73b7.js"><link rel="prefetch" href="/study-collection/assets/js/110.fef9d612.js"><link rel="prefetch" href="/study-collection/assets/js/111.48ee8ffc.js"><link rel="prefetch" href="/study-collection/assets/js/112.9b5be697.js"><link rel="prefetch" href="/study-collection/assets/js/113.0d62c5db.js"><link rel="prefetch" href="/study-collection/assets/js/114.a62f700b.js"><link rel="prefetch" href="/study-collection/assets/js/115.9ecf1383.js"><link rel="prefetch" href="/study-collection/assets/js/116.f60800af.js"><link rel="prefetch" href="/study-collection/assets/js/117.ce283393.js"><link rel="prefetch" href="/study-collection/assets/js/118.30347e91.js"><link rel="prefetch" href="/study-collection/assets/js/119.772888f3.js"><link rel="prefetch" href="/study-collection/assets/js/12.0122e7ac.js"><link rel="prefetch" href="/study-collection/assets/js/120.ca7da326.js"><link rel="prefetch" href="/study-collection/assets/js/121.9722214f.js"><link rel="prefetch" href="/study-collection/assets/js/122.292cc80f.js"><link rel="prefetch" href="/study-collection/assets/js/123.85da1be5.js"><link rel="prefetch" href="/study-collection/assets/js/124.a8ee7334.js"><link rel="prefetch" href="/study-collection/assets/js/125.50f4e7f2.js"><link rel="prefetch" href="/study-collection/assets/js/126.e0acd1a6.js"><link rel="prefetch" href="/study-collection/assets/js/127.b72cb103.js"><link rel="prefetch" href="/study-collection/assets/js/128.96b487ae.js"><link rel="prefetch" href="/study-collection/assets/js/129.bbafd600.js"><link rel="prefetch" href="/study-collection/assets/js/13.3344a37e.js"><link rel="prefetch" href="/study-collection/assets/js/130.d34ac31b.js"><link rel="prefetch" href="/study-collection/assets/js/131.2128198e.js"><link rel="prefetch" href="/study-collection/assets/js/132.7cfc79e8.js"><link rel="prefetch" href="/study-collection/assets/js/133.2234db6b.js"><link rel="prefetch" href="/study-collection/assets/js/134.1d7ad0fd.js"><link rel="prefetch" href="/study-collection/assets/js/135.ab00652d.js"><link rel="prefetch" href="/study-collection/assets/js/136.163467bf.js"><link rel="prefetch" href="/study-collection/assets/js/137.8b3efe2f.js"><link rel="prefetch" href="/study-collection/assets/js/138.9289f501.js"><link rel="prefetch" href="/study-collection/assets/js/139.afbbe803.js"><link rel="prefetch" href="/study-collection/assets/js/14.f3b9c607.js"><link rel="prefetch" href="/study-collection/assets/js/140.579f2e7f.js"><link rel="prefetch" href="/study-collection/assets/js/141.2154ba71.js"><link rel="prefetch" href="/study-collection/assets/js/142.23f17e98.js"><link rel="prefetch" href="/study-collection/assets/js/143.261c5b20.js"><link rel="prefetch" href="/study-collection/assets/js/144.d55c4a30.js"><link rel="prefetch" href="/study-collection/assets/js/145.026a54a1.js"><link rel="prefetch" href="/study-collection/assets/js/146.842330f2.js"><link rel="prefetch" href="/study-collection/assets/js/147.4a9d1ea2.js"><link rel="prefetch" href="/study-collection/assets/js/15.30907678.js"><link rel="prefetch" href="/study-collection/assets/js/16.f5cedbd4.js"><link rel="prefetch" href="/study-collection/assets/js/17.f1565925.js"><link rel="prefetch" href="/study-collection/assets/js/18.16239dae.js"><link rel="prefetch" href="/study-collection/assets/js/19.81a3982f.js"><link rel="prefetch" href="/study-collection/assets/js/20.9aa987b5.js"><link rel="prefetch" href="/study-collection/assets/js/21.8fe12c38.js"><link rel="prefetch" href="/study-collection/assets/js/22.10dadf8e.js"><link rel="prefetch" href="/study-collection/assets/js/23.d422d817.js"><link rel="prefetch" href="/study-collection/assets/js/24.6dff9a81.js"><link rel="prefetch" href="/study-collection/assets/js/25.dd336119.js"><link rel="prefetch" href="/study-collection/assets/js/26.fefadb9d.js"><link rel="prefetch" href="/study-collection/assets/js/27.00e435dc.js"><link rel="prefetch" href="/study-collection/assets/js/28.90a5cc4d.js"><link rel="prefetch" href="/study-collection/assets/js/29.c54ba6d2.js"><link rel="prefetch" href="/study-collection/assets/js/3.05fb6856.js"><link rel="prefetch" href="/study-collection/assets/js/30.3c450b07.js"><link rel="prefetch" href="/study-collection/assets/js/31.4197e2e6.js"><link rel="prefetch" href="/study-collection/assets/js/32.4f594fa6.js"><link rel="prefetch" href="/study-collection/assets/js/33.69f666ba.js"><link rel="prefetch" href="/study-collection/assets/js/34.11351401.js"><link rel="prefetch" href="/study-collection/assets/js/35.ed7f1908.js"><link rel="prefetch" href="/study-collection/assets/js/36.9a48a846.js"><link rel="prefetch" href="/study-collection/assets/js/37.754b7fb7.js"><link rel="prefetch" href="/study-collection/assets/js/38.b5824095.js"><link rel="prefetch" href="/study-collection/assets/js/39.3a3bf454.js"><link rel="prefetch" href="/study-collection/assets/js/4.cca17128.js"><link rel="prefetch" href="/study-collection/assets/js/40.71901c6f.js"><link rel="prefetch" href="/study-collection/assets/js/41.1d9ec45e.js"><link rel="prefetch" href="/study-collection/assets/js/42.209136da.js"><link rel="prefetch" href="/study-collection/assets/js/43.d021e92e.js"><link rel="prefetch" href="/study-collection/assets/js/44.e72274f9.js"><link rel="prefetch" href="/study-collection/assets/js/45.fc8d0d14.js"><link rel="prefetch" href="/study-collection/assets/js/46.b870c49e.js"><link rel="prefetch" href="/study-collection/assets/js/47.070a6fe7.js"><link rel="prefetch" href="/study-collection/assets/js/48.9a3f214a.js"><link rel="prefetch" href="/study-collection/assets/js/49.ee631e58.js"><link rel="prefetch" href="/study-collection/assets/js/5.11dc2aa1.js"><link rel="prefetch" href="/study-collection/assets/js/50.831dfcfe.js"><link rel="prefetch" href="/study-collection/assets/js/51.1ca0111d.js"><link rel="prefetch" href="/study-collection/assets/js/52.69ef894d.js"><link rel="prefetch" href="/study-collection/assets/js/53.97f078f3.js"><link rel="prefetch" href="/study-collection/assets/js/54.979a1e24.js"><link rel="prefetch" href="/study-collection/assets/js/55.a462258c.js"><link rel="prefetch" href="/study-collection/assets/js/56.7333f0de.js"><link rel="prefetch" href="/study-collection/assets/js/57.90c23cc6.js"><link rel="prefetch" href="/study-collection/assets/js/58.6f4a43e2.js"><link rel="prefetch" href="/study-collection/assets/js/59.70dc89fb.js"><link rel="prefetch" href="/study-collection/assets/js/6.77504fd7.js"><link rel="prefetch" href="/study-collection/assets/js/60.1df7cddb.js"><link rel="prefetch" href="/study-collection/assets/js/61.8ba0c0be.js"><link rel="prefetch" href="/study-collection/assets/js/62.bded6c1b.js"><link rel="prefetch" href="/study-collection/assets/js/63.c0f679cb.js"><link rel="prefetch" href="/study-collection/assets/js/64.0b6b2f53.js"><link rel="prefetch" href="/study-collection/assets/js/65.94a98ac5.js"><link rel="prefetch" href="/study-collection/assets/js/66.47c94771.js"><link rel="prefetch" href="/study-collection/assets/js/67.4341fd5a.js"><link rel="prefetch" href="/study-collection/assets/js/68.3e48d8c3.js"><link rel="prefetch" href="/study-collection/assets/js/69.338281b8.js"><link rel="prefetch" href="/study-collection/assets/js/7.9d69566f.js"><link rel="prefetch" href="/study-collection/assets/js/70.f6a9ecaf.js"><link rel="prefetch" href="/study-collection/assets/js/71.435ae077.js"><link rel="prefetch" href="/study-collection/assets/js/72.ef882f65.js"><link rel="prefetch" href="/study-collection/assets/js/73.ee2242e2.js"><link rel="prefetch" href="/study-collection/assets/js/74.cb9e9e46.js"><link rel="prefetch" href="/study-collection/assets/js/75.c00ef0fd.js"><link rel="prefetch" href="/study-collection/assets/js/76.00c54abb.js"><link rel="prefetch" href="/study-collection/assets/js/77.48d90bd9.js"><link rel="prefetch" href="/study-collection/assets/js/78.aca2294e.js"><link rel="prefetch" href="/study-collection/assets/js/79.d0fcf884.js"><link rel="prefetch" href="/study-collection/assets/js/8.bb2ddfb0.js"><link rel="prefetch" href="/study-collection/assets/js/80.6a5dc053.js"><link rel="prefetch" href="/study-collection/assets/js/81.05926199.js"><link rel="prefetch" href="/study-collection/assets/js/82.0669a1b0.js"><link rel="prefetch" href="/study-collection/assets/js/83.e8cf3303.js"><link rel="prefetch" href="/study-collection/assets/js/84.8d688cb9.js"><link rel="prefetch" href="/study-collection/assets/js/85.08ece1e8.js"><link rel="prefetch" href="/study-collection/assets/js/86.427c8054.js"><link rel="prefetch" href="/study-collection/assets/js/87.251ab478.js"><link rel="prefetch" href="/study-collection/assets/js/88.70b1e088.js"><link rel="prefetch" href="/study-collection/assets/js/89.41d2de15.js"><link rel="prefetch" href="/study-collection/assets/js/9.ed0486bd.js"><link rel="prefetch" href="/study-collection/assets/js/91.f6467cba.js"><link rel="prefetch" href="/study-collection/assets/js/92.bc989a49.js"><link rel="prefetch" href="/study-collection/assets/js/93.96a7145c.js"><link rel="prefetch" href="/study-collection/assets/js/94.30fd4f28.js"><link rel="prefetch" href="/study-collection/assets/js/95.a1fec989.js"><link rel="prefetch" href="/study-collection/assets/js/96.eadec6b7.js"><link rel="prefetch" href="/study-collection/assets/js/97.2ccf1463.js"><link rel="prefetch" href="/study-collection/assets/js/98.232b1ffc.js"><link rel="prefetch" href="/study-collection/assets/js/99.245442f4.js">
    <link rel="stylesheet" href="/study-collection/assets/css/0.styles.d9b30d9c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study-collection/" class="home-link router-link-active"><!----> <span class="site-name">끄적끄적 블로그</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study-collection/guide.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="https://github.com/gwegwe1234/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study-collection/guide.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="https://github.com/gwegwe1234/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/study-collection/guide.html" class="sidebar-link">Intro</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Book summary</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>자바 프로그래밍 면접 이렇게 준비한다</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/study-collection/book/JPIE/04.html" class="sidebar-link">4장 기본 알고리즘 작성하기</a></li><li><a href="/study-collection/book/JPIE/05.html" class="sidebar-link">5장 자료구조</a></li><li><a href="/study-collection/book/JPIE/06.html" class="sidebar-link">6장 디자인 패턴</a></li><li><a href="/study-collection/book/JPIE/07.html" class="sidebar-link">7장 자주 묻는 면접 알고리즘 구현하기</a></li><li><a href="/study-collection/book/JPIE/08.html" class="sidebar-link">8장 자바 기본</a></li><li><a href="/study-collection/book/JPIE/09.html" class="sidebar-link">9장 JUnit으로 테스팅하기</a></li><li><a href="/study-collection/book/JPIE/10.html" class="active sidebar-link">10장 자바 가상머신 이해하기</a></li><li><a href="/study-collection/book/JPIE/11.html" class="sidebar-link">11장 동시성</a></li><li><a href="/study-collection/book/JPIE/12.html" class="sidebar-link">12장 자바 어플리케이션과 데이터베이스 통합하기</a></li><li><a href="/study-collection/book/JPIE/13.html" class="sidebar-link">13장 웹 어플리케이션 만들기</a></li><li><a href="/study-collection/book/JPIE/14.html" class="sidebar-link">14장 HTTP와 REST 이용하기</a></li><li><a href="/study-collection/book/JPIE/15.html" class="sidebar-link">15장 직렬화</a></li><li><a href="/study-collection/book/JPIE/16.html" class="sidebar-link">16장 스프링 프레임워크</a></li><li><a href="/study-collection/book/JPIE/17.html" class="sidebar-link">17장 하이버네이트 사용하기</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>클린코드</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>스프링 인 액션</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>고 인 액션</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Go 언어를 활용한 마이크로서비스 개발</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>마이크로서비스 구축과 운영</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>카프카 스트림즈 인 액션</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>모던 자바 인 액션</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>객체지향의 사실과 오해</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>뇌를 자극하는 윈도우즈 시스템 프로그래밍</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>스프링5를 활용한 리액티브 프로그래밍</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tech</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_10강"><a href="#_10강" class="header-anchor">#</a> 10강</h1> <p></p><div class="table-of-contents"><ul><li><a href="#가비지-컬렉션">가비지 컬렉션</a><ul><li><a href="#q1-메모리는-어떻게-할당하는가">Q1. 메모리는 어떻게 할당하는가?</a></li><li><a href="#q2-가비지-컬렉션이란-무엇인가">Q2. 가비지 컬렉션이란 무엇인가?</a></li></ul></li><li><a href="#메모리-튜닝">메모리 튜닝</a><ul><li><a href="#q3-스택과-힙의-차이는-무엇인가">Q3. 스택과 힙의 차이는 무엇인가?</a></li><li><a href="#q4-jvm의-힙-크기는-어떻게-지정할-수-있는가">Q4. JVM의 힙 크기는 어떻게 지정할 수 있는가?</a></li><li><a href="#q5-자바에서-메모리-누수가-발생할-수-있는가">Q5. 자바에서 메모리 누수가 발생할 수 있는가?</a></li></ul></li><li><a href="#jvm과-자바-사이의-상호작용">JVM과 자바 사이의 상호작용</a><ul><li><a href="#q6-jvm에서-동작하는-실제-자바-코드를-작성할-때-생명주기란-무엇인가">Q6. JVM에서 동작하는 실제 자바 코드를 작성할 때 생명주기란 무엇인가?</a></li><li><a href="#q7-jvm에게-가비지-컬렉션을-실행하라고-직접-명령할-수-잇는가">Q7. JVM에게 가비지 컬렉션을 실행하라고 직접 명령할 수 잇는가?</a></li><li><a href="#q8-finalize-메소드는-어떤-역할을-하는가">Q8. finalize 메소드는 어떤 역할을 하는가?</a></li><li><a href="#q9-weakreference란-무엇인가">Q9. WeakReference란 무엇인가?</a></li><li><a href="#q10-native-메소드란-무엇인가">Q10. native 메소드란 무엇인가?</a></li><li><a href="#q11-셧다운-훅이란-무엇인가">Q11. 셧다운 훅이란 무엇인가?</a></li></ul></li></ul></div><p></p> <h2 id="가비지-컬렉션"><a href="#가비지-컬렉션" class="header-anchor">#</a> 가비지 컬렉션</h2> <h3 id="q1-메모리는-어떻게-할당하는가"><a href="#q1-메모리는-어떻게-할당하는가" class="header-anchor">#</a> Q1. 메모리는 어떻게 할당하는가?</h3> <ul><li>new 키워드는 자바 힙 영역에 메모리를 할당한다.</li> <li>힙은 어플리케이션 영역에 접근할 수 있는 메모리의 메인 영역</li> <li>객체를 할당할 때 이용할 수 있는 메모리가 충분하지 않으면, JVM은 GC를 이용해 힙에서 메모리를 재사용 하려고 한다.</li> <li>만약 메모리가 터져버리면 OutOfMemoryError가 발생하며 JVM이 종료된다.</li> <li>힙은 제너레이션이라는 영역으로 구분되는데, GC에서 객체가 수집 대상에서 제외되면 다른 제너레이션으로 옮겨진다.</li> <li>객체가 처음 생성됐을 때는 Eden이라고 하는 메모리 영역에 할당된다.</li> <li>이후 GC의 수집 대상에서 제외되면 Survivor라고 하는 메모리 영역으로 옮겨지며, 이 공간에서 수집 대상에서 제외되는 객체는 Tenured 제너레이션에 할당 된다.</li></ul> <h3 id="q2-가비지-컬렉션이란-무엇인가"><a href="#q2-가비지-컬렉션이란-무엇인가" class="header-anchor">#</a> Q2. 가비지 컬렉션이란 무엇인가?</h3> <ul><li>가비지 컬렉션(GC)는 기존에 할당된 메모리를 재사용하는 메커니즘</li> <li>자바에선 자동으로 관리해 잠재적으로 발생할 수 있는 실수를 예방해 준다.</li> <li>자바의 전통적인 가비지 컬렉션은 <em>mark-and-sweep</em> 방식</li> <li>실행중인 코드에서 참조하는 객체는 live로 표시되고, 이어서 참조되는 것들도 live로 표시한다.</li> <li>이러한 과정이 끝나면 힙에 있는 각 객체들을 찾아다니며 live로 표시되지 않은 메모리 위치에 메모리를 할당할 수 있게 만든다.</li> <li>이 과정이 진행되는 동안 메모리를 재배치하려고 JVM의 모든 스레드가 정지되는데, <em>stop-the-world</em> 라고 부른다.</li> <li>자바의 GC는 최대한 많은 빈 메모리 영역을 확보하기 위해, 컴패션 작업을 진행한다.</li> <li>컴패션은 live로 표시한 객체들을 다른 물리적인 메모리 위치로 옮김으로써, JVM이 stop-the-world인 동안 메모리 공간을 확보한다.</li> <li><a href="https://preamtree.tistory.com/118" target="_blank" rel="noopener noreferrer">GC 참고 글<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="메모리-튜닝"><a href="#메모리-튜닝" class="header-anchor">#</a> 메모리 튜닝</h2> <h3 id="q3-스택과-힙의-차이는-무엇인가"><a href="#q3-스택과-힙의-차이는-무엇인가" class="header-anchor">#</a> Q3. 스택과 힙의 차이는 무엇인가?</h3> <ul><li>스택 : 기본값, 객체의 참조, 메소드가 저장되는 위치
<ul><li>스택에 있는 변수의 생애주기는 코드의 scope에 영향을 받는다.</li> <li>일반적인 메소드 호출이나, for / while 문 같은 코드의 괄호로 구분해서 정의</li> <li>해당 스코프 실행이 종료되면 스코프 안에 선언된 변수들은 스택에서 제거된다.</li> <li>메소드를 호출하면 선언된 변수들은 스택의 상단에 위치된다.</li> <li>스택에서 다른 메소드를 호출하면 스택은 새로운 메소드의 변수를 스택의 상단에 둔다.</li></ul></li> <li>재귀를 많이하면 스택 영역이 가득차고 StackOverFlowError가 발생한다.</li> <li><a href="https://namu.wiki/w/%EC%8A%A4%ED%83%9D(%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0)" target="_blank" rel="noopener noreferrer">스택 참고 글<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="q4-jvm의-힙-크기는-어떻게-지정할-수-있는가"><a href="#q4-jvm의-힙-크기는-어떻게-지정할-수-있는가" class="header-anchor">#</a> Q4. JVM의 힙 크기는 어떻게 지정할 수 있는가?</h3> <ul><li>-Xmx 매개변수로 최대 힙 크기 지정이 가능하다.
<ul><li>'java -Xmx512M <code>&lt;classname&gt;</code>' 으로 JVM을 실행하면 JVM은 512MB 최대 힙 크기를 가진 JVM을 생성한다.</li></ul></li> <li>Xms 매개변수로 JVM에 할당할 초기 메모리 지정이 가능하다.</li> <li>두 개의 매개변수가 같은 값으로 설정되면 JVM은 실행할 때 모든 메모리를 할당하도록 운영체제에 요청한다.</li></ul> <h3 id="q5-자바에서-메모리-누수가-발생할-수-있는가"><a href="#q5-자바에서-메모리-누수가-발생할-수-있는가" class="header-anchor">#</a> Q5. 자바에서 메모리 누수가 발생할 수 있는가?</h3> <ul><li>자동 GC로 메모리 누수가 없을 것 같지만, 누수 발생이 가능하다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MemoryLeakStack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> stackValues<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> stackPointer<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">MemoryLeakStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stackValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stackPointer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stackValues<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>stackPointer<span class="token punctuation">,</span> element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    stackPointer<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stackPointer<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> stackValues<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>stackPointer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>동시성이 고려되지 않은 코드로, 여러군대에서 붙으면 쓸모가 없지만 GC가 잡아낼 수가 없다.</li></ul> <h2 id="jvm과-자바-사이의-상호작용"><a href="#jvm과-자바-사이의-상호작용" class="header-anchor">#</a> JVM과 자바 사이의 상호작용</h2> <h3 id="q6-jvm에서-동작하는-실제-자바-코드를-작성할-때-생명주기란-무엇인가"><a href="#q6-jvm에서-동작하는-실제-자바-코드를-작성할-때-생명주기란-무엇인가" class="header-anchor">#</a> Q6. JVM에서 동작하는 실제 자바 코드를 작성할 때 생명주기란 무엇인가?</h3> <ul><li>클래스 파일은 JVM에서 돌기 위한 자바 소스가 컴파일된 바이트코드이다.</li> <li>클래스 정의의 바이트코드를 실행 중인 JVM의 메모리로 가져오는걸 클래스 로딩 이라고 부른다.</li> <li>클래스 로더는 클래스 파일을 추상화해 디스크, 네트워크, JAR 같은 압축 파일에서 불러올 수 있다.</li> <li>사용자가 직접 클래스로더를 만들면, 특정 위치에서 찾은 클래스를 직접 만든 클래스 로더에서 사용하도록 어플리케이션을 실행할 수 있다.</li> <li>클래스가 로드되면, JVM은 바이트코드가 유효한지 검증하고, 코드가 실행되는 아키텍쳐와 운영체제에 맞춰 명령어로 바이트 코드를 해석할 수 있다.</li></ul> <h3 id="q7-jvm에게-가비지-컬렉션을-실행하라고-직접-명령할-수-잇는가"><a href="#q7-jvm에게-가비지-컬렉션을-실행하라고-직접-명령할-수-잇는가" class="header-anchor">#</a> Q7. JVM에게 가비지 컬렉션을 실행하라고 직접 명령할 수 잇는가?</h3> <ul><li>System 클래스의 전역 메소드인 gc로 가비지 컬렉션을 실행하라고 명령 할 수 있다.</li> <li>하지만 이 메소드를 호출하다고 반드시 가비지 컬렉션이 실행되는 보장은 없다.</li></ul> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>gc 메소드를 호출하면 자바 가상머신은 현재 차지하는 메모리를 빠르게 재사용할 수 있게 하기 위해 사용하지 않는 객체를 재생하려고 한다. 메소드 호출에서 실행 흐림이 반환됐을 때, 자바 가상머신은 모든 쓸모 없는 객체들에서 반환받은 공간을 재배치하는데 최선의 노력을 다한다.</p></div> <ul><li>gc메소드를 호출하면, stop-the-world 상태가 되어 코드 실행이 느려진다.</li> <li>gc 호출은 가급적 하지말고, 그냥 문제가 발생한 부분을 코드적으로 해결을 하자</li></ul> <h3 id="q8-finalize-메소드는-어떤-역할을-하는가"><a href="#q8-finalize-메소드는-어떤-역할을-하는가" class="header-anchor">#</a> Q8. finalize 메소드는 어떤 역할을 하는가?</h3> <ul><li>finalize 메소드는 Object 클래스에서 상속된 protected 메소드이다.</li> <li>JVM이 GC를 통해 객체를 수집할 때 가장 머저 호출하는 메소드이다.</li> <li>이 메소드는 가비지 컬렉션에서 수집해야 하는 객체와 연관된 모든 자원을 제거하는 데 필요한 작업을 한다.</li> <li>finalize를 오버라이딩 하면 해당 메소드가 언제 호출되는지 제어 할 수 없어 위험하다.</li></ul> <h3 id="q9-weakreference란-무엇인가"><a href="#q9-weakreference란-무엇인가" class="header-anchor">#</a> Q9. WeakReference란 무엇인가?</h3> <ul><li>WeakReference는 제너릭 컨테이너 클래스이다.</li> <li>들어있는 인스턴스에 강력한 참조가 없으면 가비지 컬렉션의 수집대상이 될 수 있다.</li> <li>아래의 코드에서 스택 구현의 문제를 해결하려면 원소들의 WeakReferences 리스트를 유지해야 한다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeakReferenceStack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WeakReference</span><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> stackReferences<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> stackPointer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name">WeakReferenceStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stackReferences <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">push</span><span class="token punctuation">(</span><span class="token class-name">E</span> element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>stackReferences<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
        stackPointer<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stackPointer<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stackPointer<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stackReferences<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>stackPointer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stackReferences<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>stackPointer<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>스택에 새로운 원소가 들어왔을 때 WeakReference 객체로 저장되고 객체가 pop 될땐 WeakReference 객체를 검색하고 객체를 얻기 위해 get 메소드가 호출된다.</li> <li>해당 객체를 가리키는 클라이언트 코드가 없을 때, 다음 가비지 컬렉션이 실행 될 때 삭제 대상으로 선택될 수 있다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WeakReferenceTest</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">weakReferenceStackManipulation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token class-name">WeakReferenceStack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ValueContainer</span><span class="token punctuation">&gt;</span></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakReferenceStack</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">ValueContainer</span> expected <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ValueContainer</span><span class="token punctuation">(</span><span class="token string">&quot;Value for the stack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValueContainer</span><span class="token punctuation">(</span><span class="token string">&quot;Value for the stack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ValueContainer</span> peekedValue <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assertEquals</span><span class="token punctuation">(</span>expected<span class="token punctuation">,</span> peekedValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assertEquals</span><span class="token punctuation">(</span>expected<span class="token punctuation">,</span> stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    peekedValue <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assertNull</span><span class="token punctuation">(</span>stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ValueContainer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> value<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">ValueContainer</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
      <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;Finalizing for [%s]%n&quot;</span><span class="token punctuation">,</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>stack.push 같은 형태로 스택에 객체를 삽입하면 강한 참조가 유지된다.</li> <li>이럴 경우 가비지 컬렉션에서 수집을 실행하지 않아, gc에서 수집이 되지 않는다.</li></ul> <h3 id="q10-native-메소드란-무엇인가"><a href="#q10-native-메소드란-무엇인가" class="header-anchor">#</a> Q10. native 메소드란 무엇인가?</h3> <ul><li>자바 클래스는 바이트코드로 컴파일해 클래스 파일에 저장된다.</li> <li>이러한 바이트코드는 플랫폼 독립적이어야 하지만, 일부 플랫폼 지정 코드, 플랫폼 지정 라이브러리같은 운영체제 수준의 자원을 호출할 수 있어야 한다.</li> <li>이런 자원 호출을 JVM을 이용하는 대부분의 각 플랫폼에 구현되어 있다.</li> <li>자원 호출을 할 수 없는 경우에는 C나 C++의 잘 정의된 헤더를 이용할 수 있는 native 메소드 사용이 가능하다.</li> <li>즉 이 메소드를 사용해 클래스이름, 자바 메소드 이름, 매개변수와 반환 타입까지 구분할 수 있다.</li></ul> <h3 id="q11-셧다운-훅이란-무엇인가"><a href="#q11-셧다운-훅이란-무엇인가" class="header-anchor">#</a> Q11. 셧다운 훅이란 무엇인가?</h3> <ul><li>JVM이 종료되기 직전에 실행하는 코드를 셧다운 훅이라고 한다.</li> <li>셧다운 훅은 Thread 객체에 대한 참조다.</li> <li>즉 현재 Runtime 인스턴스의 addShutdownHook 메소드를 호출해 새로운 참조를 추가할 수 있다.</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShutdownHookTest</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Test</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addShudownHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addShutdownHook</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token annotation punctuation">@Override</span>
      <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Shutting down JVM at time: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">Shutting</span> down JVM at time<span class="token operator">:</span> <span class="token class-name">Tue</span> <span class="token class-name">Dec</span> <span class="token number">31</span> <span class="token number">23</span><span class="token operator">:</span><span class="token number">30</span><span class="token operator">:</span><span class="token number">31</span> KST <span class="token number">2019</span>
</code></pre></div><ul><li>종료시에 시간을 찍어줘, 예기치 못한 JVM 종료될 때 내용을 알리는거와 같은 기능을 추가 할 수 있다.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/study-collection/book/JPIE/09.html" class="prev">9장 JUnit으로 테스팅하기</a></span> <span class="next"><a href="/study-collection/book/JPIE/11.html">11장 동시성</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/study-collection/assets/js/app.9903441f.js" defer></script><script src="/study-collection/assets/js/2.aa424286.js" defer></script><script src="/study-collection/assets/js/90.82984209.js" defer></script>
  </body>
</html>
