(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{638:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_13강"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_13강"}},[t._v("#")]),t._v(" 13강")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#_1-캐시-지원하기"}},[t._v("1. 캐시 지원하기")]),s("ul",[s("li",[s("a",{attrs:{href:"#_1-1-캐시-매니저-설정하기"}},[t._v("1-1. 캐시 매니저 설정하기")])])])]),s("li",[s("a",{attrs:{href:"#_2-캐싱을-위한-어노테이션-메소드"}},[t._v("2. 캐싱을 위한 어노테이션 메소드")]),s("ul",[s("li",[s("a",{attrs:{href:"#_2-1-캐시-채우기"}},[t._v("2-1. 캐시 채우기")])]),s("li",[s("a",{attrs:{href:"#_2-2-캐시-엔트리-삭제하기"}},[t._v("2-2. 캐시 엔트리 삭제하기")])])])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"_1-캐시-지원하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-캐시-지원하기"}},[t._v("#")]),t._v(" 1. 캐시 지원하기")]),t._v(" "),s("ul",[s("li",[t._v("스프링의 캐시 추상화 지원\n"),s("ul",[s("li",[t._v("어노테이션 주도 캐싱")]),t._v(" "),s("li",[t._v("XML 선언 캐싱")])])])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableCaching")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CachingConfig")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentMapCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("@EnableCaching 어노테이션을 사용해 빈설정")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("beans")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xmlns")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.springframework.org/schema/beans"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("xsi")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.w3.org/2001/XMLSchema-instance"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xmlns:")]),t._v("cache")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.springframework.org/schema/cache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("xsi:")]),t._v("schemaLocation")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("\n    http://www.springframework.org/schema/beans\n    http://www.springframework.org/schema/beans/spring-beans.xsd\n    http://www.springframework.org/schema/cache\n    http://www.springframework.org/schema/cache/spring-cache.xsd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("cache:")]),t._v("annotation-driven")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\t\n\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("bean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("cacheManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("org.springframework.cache.concurrent.ConcurrentMapCacheManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\t\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("beans")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("ul",[s("li",[t._v("xml 서정")]),t._v(" "),s("li",[t._v("@EnableCaching과 <cache:annotation-driven />은 동일하게, 스프링의 캐싱 어노테이션을 하는 포인트커트를 가지는 애스펙트를 생성한다.")]),t._v(" "),s("li",[t._v("캐시 상태와 어노테이션에 따라 애스펙트는 캐시의 값을 가져오고, 캐시에 값을 추가하고, 캐시의 값을 삭제한다.")]),t._v(" "),s("li",[t._v("CacheManager는 스프링 캐시 정책의 핵심")])]),t._v(" "),s("h3",{attrs:{id:"_1-1-캐시-매니저-설정하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-캐시-매니저-설정하기"}},[t._v("#")]),t._v(" 1-1. 캐시 매니저 설정하기")]),t._v(" "),s("ul",[s("li",[t._v("스프링은 5개의 캐시 매니저 구현체를 지원한다\n"),s("ul",[s("li",[t._v("SimpleCacheManager")]),t._v(" "),s("li",[t._v("NoOpCacheManager")]),t._v(" "),s("li",[t._v("ConcurrentMapCacheManager")]),t._v(" "),s("li",[t._v("CompositeCacheManager")]),t._v(" "),s("li",[t._v("EhCacheCacheManager")])])]),t._v(" "),s("li",[t._v("추가적으로 스프링 데이터는 2개의 추가 캐시 매니저를 제공\n"),s("ul",[s("li",[t._v("RedisCacheManager")]),t._v(" "),s("li",[t._v("GemfireCacheManager")])])])]),t._v(" "),s("h4",{attrs:{id:"ehcache로-캐싱하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ehcache로-캐싱하기"}},[t._v("#")]),t._v(" EhCache로 캐싱하기")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableCaching")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CachingConfig")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EhCacheCacheManager")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),t._v(" cm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\t\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EhCacheCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EhCacheManagerFactoryBean")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ehcache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\t\n     "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EhCacheManagerFactoryBean")]),t._v(" ehCacheFactoryBean "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EhCacheManagerFactoryBean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ehCacheFactoryBean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setConfigLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClassPathResource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com/habuma/spittr/cache/ehcache.xml"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ehCacheFactoryBean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("EhCacheCacheManager빈을 설정하기 위해, CacheManager 타입의 변수가 주입된다.")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ehcache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("cache")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("spittleCache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("maxBytesLocalHeap")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("50m"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("timeToLiveSeconds")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("100"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("cache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ehcache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(">\n")])])]),s("ul",[s("li",[t._v("갖고오는 xml 설정 파일")])]),t._v(" "),s("h4",{attrs:{id:"캐싱을-위해-redis-사용하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#캐싱을-위해-redis-사용하기"}},[t._v("#")]),t._v(" 캐싱을 위해 Redis 사용하기")]),t._v(" "),s("ul",[s("li",[t._v("Redis는 key-value 쌍으로 디비 말고 캐시로 써도 된다.")]),t._v(" "),s("li",[t._v("스프링 데이터는 RedisCacheManager를 제공한다.")]),t._v(" "),s("li",[t._v("RedisTemplate, RedisCacheManager 설정이 필요")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableCaching")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CachingConfig")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),t._v(" redisTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("redisTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JedisConnectionFactory")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("redisConnectionFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\t\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JedisConnectionFactory")]),t._v(" jedisConnectionFactory "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JedisConnectionFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   jedisConnectionFactory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("afterPropertiesSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jedisConnectionFactory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("redisTemplate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\t\n           "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisConnectionFactory")]),t._v(" redisCF"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" redisTemplate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisTemplate")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    redisTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setConnectionFactory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("redisCF"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    redisTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("afterPropertiesSet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" redisTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"다중-캐시-매니저-사용하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#다중-캐시-매니저-사용하기"}},[t._v("#")]),t._v(" 다중 캐시 매니저 사용하기")]),t._v(" "),s("ul",[s("li",[t._v("CompositeCacheManager를 사용해 여러개의 캐시를 사용해도 된다")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      net"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ehcache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),t._v(" cm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      javax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),t._v(" jcm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompositeCacheManager")]),t._v(" cacheManager "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompositeCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\n  "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" managers "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  managers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("JCacheCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jcm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  managers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EhCacheCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  managers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisCacheManager")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("redisTemplate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  cacheManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCacheManagers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("managers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\t\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" cacheManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("CompositeCacheManager 를 선언하고, managers에 각 캐시매니저를 넣은 후, 설정해 준다.")])]),t._v(" "),s("h2",{attrs:{id:"_2-캐싱을-위한-어노테이션-메소드"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-캐싱을-위한-어노테이션-메소드"}},[t._v("#")]),t._v(" 2. 캐싱을 위한 어노테이션 메소드")]),t._v(" "),s("ul",[s("li",[t._v("스프링에서 캐싱을 사용할 때, 애스펙트는 한 개 이상의 스프링 캐싱 어노테이션을 시작하기 위해 만들어진다.")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("어노테이션")]),t._v(" "),s("th",[t._v("내용")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("@Cacheable")]),t._v(" "),s("td",[t._v("스프링이 메소드 사용 전에 메소드 반환값을 위해 캐시를 살펴본다. 값이 존재할 경우, 캐시된 값이 반환된다. 값이 존재하지 않는다면 메소드가 실행되고 반환된 값이 캐시에 남는다")])]),t._v(" "),s("tr",[s("td",[t._v("@CachePut")]),t._v(" "),s("td",[t._v("스프링이 캐시에 메소드 반환 값을 저장한다. 캐시는 메소드 실행 전에는 체크되지 않으며, 메소드는 항상 실행된다")])]),t._v(" "),s("tr",[s("td",[t._v("@CacheEvict")]),t._v(" "),s("td",[t._v("스프링이 캐시에서 한 개 이상의 엔트리를 내쫓는다")])]),t._v(" "),s("tr",[s("td",[t._v("@Caching")]),t._v(" "),s("td",[t._v("다른 캐싱 어노테이션을 여러 번 즉시 적용하기 위해 사용할 수 있는 그룹 어노테이션")])])])]),t._v(" "),s("ul",[s("li",[t._v("위의 어노테이션은 메소드와 클래스 둘 다 사용 가능하다.")])]),t._v(" "),s("h3",{attrs:{id:"_2-1-캐시-채우기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-캐시-채우기"}},[t._v("#")]),t._v(" 2-1. 캐시 채우기")]),t._v(" "),s("ul",[s("li",[t._v("@Cacheable\n"),s("ul",[s("li",[t._v("캐시의 엔트리를 찾고, 매칭되는 엔트리가 발견되면 메소드 호출을 미리 수행")]),t._v(" "),s("li",[t._v("매칭되는 엔트리가 없으면, 메소드의 반환값이 캐시에 저장")])])]),t._v(" "),s("li",[t._v("@CachePut\n"),s("ul",[s("li",[t._v("캐시 내에 매칭 값은 체크 x. 타깃 메소드의 반환값을 캐시에 추가")])])]),t._v(" "),s("li",[t._v("@Cacheable과 @CachePut은 어트리뷰트 공통 세트 공유 (아래표)")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("어트리뷰트")]),t._v(" "),s("th",[t._v("타입")]),t._v(" "),s("th",[t._v("내용")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("value")]),t._v(" "),s("td",[t._v("String[]")]),t._v(" "),s("td",[t._v("사용할 캐시 명")])]),t._v(" "),s("tr",[s("td",[t._v("condition")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("SpEL 표현식, 값이 false 이면 캐싱은 메소드 호출에 적용되지 않음")])]),t._v(" "),s("tr",[s("td",[t._v("key")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("맞춤형 캐시 키를 계산하기 위한 SpEL")])]),t._v(" "),s("tr",[s("td",[t._v("unless")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("SpEL 표현식, 값이 true이면 반환 값이 캐시에 남지 않게함")])])])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Cacheable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spittleCache"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Spittle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jdbcTemplate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryForObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        SELECT_SPITTLE_BY_ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpittleRowMapper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EmptyResultDataAccessException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("DB 접근이 많은 select 쿼리 같은거에 캐시질을 하면 좋다.")]),t._v(" "),s("li",[t._v("findOne()이 호출될 때 캐싱 애스펙트는 그 호출을 가로채고, spittleCache라는 캐시의 이전 반환값을 찾는다.")]),t._v(" "),s("li",[t._v("캐시 키는 파라미터인 id이고, 값이 있으면 반환하고 메소드 실행을 안하고, 없으면 메소드 실행을 하고 저장한다.")]),t._v(" "),s("li",[t._v("실제 구현체에 @Cacheable을 달아서 한정적으로 사용되므로, 인터페이스 선언해 주는게 더 좋다.")])]),t._v(" "),s("h4",{attrs:{id:"캐시에-값-넣기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#캐시에-값-넣기"}},[t._v("#")]),t._v(" 캐시에 값 넣기")]),t._v(" "),s("ul",[s("li",[t._v("@CachePut이 어노테이션 된 메소드는 항상 호출되며, 반환값은 캐시에 들어간다.")]),t._v(" "),s("li",[t._v("캐시에 무조건 들어가므로, insert같은 곳에 적용해서 무조건 저장하고, find 할때 같은 캐시에서 찾게하는 방법을 사용한다.")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@CachePut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spittleCache"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Spittle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Spittle")]),t._v(" spittle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[t._v("이렇게 하면, 저장할 때 spittleCache캐시에 넣으므로, @Cacheable 된 find에서 바로 찾을 수 있을 것 같다.")]),t._v(" "),s("li",[t._v("하지만, 이렇게 되면 키가 달라 문제가 발생한다.\n"),s("ul",[s("li",[t._v("findOne 함수의 키는 id")]),t._v(" "),s("li",[t._v("save의 키는 spittle")])])])]),t._v(" "),s("h4",{attrs:{id:"맞춤형-캐시-키-만들기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#맞춤형-캐시-키-만들기"}},[t._v("#")]),t._v(" 맞춤형 캐시 키 만들기")]),t._v(" "),s("ul",[s("li",[t._v("스프링은 캐시 규칙을 정의하기 위해 특별히 여러 개의 SpEL 표현식을 제공한다.")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("표현식")]),t._v(" "),s("th",[t._v("내용")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("#root.args")]),t._v(" "),s("td",[t._v("인자는 캐시된 메소드에 배열로 전달된다")])]),t._v(" "),s("tr",[s("td",[t._v("#root.cache")]),t._v(" "),s("td",[t._v("메소드가 수행된 캐시이며 배열과 같다")])]),t._v(" "),s("tr",[s("td",[t._v("#root.target")]),t._v(" "),s("td",[t._v("타깃 객체를 나타낸다")])]),t._v(" "),s("tr",[s("td",[t._v("#root.targetClass")]),t._v(" "),s("td",[t._v("타깃 객체의 클래스다. #root.target.class의 숏컷")])]),t._v(" "),s("tr",[s("td",[t._v("#root.method")]),t._v(" "),s("td",[t._v("캐시된 메소드")])]),t._v(" "),s("tr",[s("td",[t._v("#root.methodName")]),t._v(" "),s("td",[t._v("캐시된 메소드 명")])]),t._v(" "),s("tr",[s("td",[t._v("#result")]),t._v(" "),s("td",[t._v("메소드 호출에서 반환된 값 (@Cacheable 에선 비유효)")])]),t._v(" "),s("tr",[s("td",[t._v("#Argument")]),t._v(" "),s("td",[t._v("메소드 인자명(#argName) 또는 인자의 인덱스 (#a0 or #p0)")])])])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@CachePut")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spittleCache"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#result.id"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Spittle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Spittle")]),t._v(" spittle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[t._v("이런식으로 고정된 키값으로 캐싱을 해줄 수 있다.")])]),t._v(" "),s("h4",{attrs:{id:"조건-캐싱"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#조건-캐싱"}},[t._v("#")]),t._v(" 조건 캐싱")]),t._v(" "),s("ul",[s("li",[t._v("unless 와 condition을 사용한다.\n"),s("ul",[s("li",[t._v("unless : SpEL 표현식 결과가 true면 메소드에서 반환된 값이 캐시에 저장되지 않음")]),t._v(" "),s("li",[t._v("condition : SpEL 표현식 결과가 false면 캐싱은 메소드에 대해 사용 불가")])])]),t._v(" "),s("li",[t._v("비슷해 보이지만, unless는 객체가 캐시에 존재하지 않게만 한다. 하지만 검색은 가능해서 매칭되는 것이 있으면 반환한다.")]),t._v(" "),s("li",[t._v("condition 은 표현식이 false면 캐싱 자체가 비활성화 되서 찾기도 안된다.")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Cacheable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spittleCache"')]),t._v(" \n           unless"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"#result.message.contains('NoCache!')\"")]),t._v("\n           condition"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#id > 10"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Spittle")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findOne")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("위의 예시로 보면, NoCache! 메세지가 포함되면, 해당 결과는 저장이 되지않는다. (찾는건 됨..?)")]),t._v(" "),s("li",[t._v("만약 id가 10보다 작으면, 아예 @Cacheable 어노테이션이 무시되서, 캐시저장, 찾기 둘다 안된다.")])]),t._v(" "),s("h3",{attrs:{id:"_2-2-캐시-엔트리-삭제하기"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-캐시-엔트리-삭제하기"}},[t._v("#")]),t._v(" 2-2. 캐시 엔트리 삭제하기")]),t._v(" "),s("ul",[s("li",[t._v("@CacheEvict는 메소드가 호출되면, 하나 이상의 엔트리들이 캐시에서 제거된다.")]),t._v(" "),s("li",[t._v("캐시값이 더이상 유효하지 않을 경우, 제거가를 한다.")]),t._v(" "),s("li",[t._v("delete 같은곳에 쓰인다.")])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@CacheEvict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spittleCache"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" spittleId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("@Cacheable, @CachePut과 달리, @CacheEvict는 void 메소드에서만 사용된다.")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("애트리뷰트")]),t._v(" "),s("th",[t._v("타입")]),t._v(" "),s("th",[t._v("내용")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("value")]),t._v(" "),s("td",[t._v("String[]")]),t._v(" "),s("td",[t._v("사용될 캐시 명")])]),t._v(" "),s("tr",[s("td",[t._v("key")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("맞춤형 캐시 키를 계산하기 위한 SpEL 표현식")])]),t._v(" "),s("tr",[s("td",[t._v("Condition")]),t._v(" "),s("td",[t._v("String")]),t._v(" "),s("td",[t._v("false로 검증되면 캐싱 내 결과는 메소드 호출에 적용되지 않는 SpEL 표현식")])]),t._v(" "),s("tr",[s("td",[t._v("allEntries")]),t._v(" "),s("td",[t._v("boolean")]),t._v(" "),s("td",[t._v("true 값을 가지면 지정 캐시 내 모든 엔트리 제거")])]),t._v(" "),s("tr",[s("td",[t._v("beforeInvocation")]),t._v(" "),s("td",[t._v("boolean")]),t._v(" "),s("td",[t._v("true 값을 가지면 메소드가 수행되기 전에 엔트리들은 캐시에서 삭제된다. false 값을 가지면 (기본) 엔트리들은 메소드 수행이 성공적으로 이루어진 이후에 제거된다.")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);